************************** CACM_CUSTOMER ******************************************
CUSTOMER_CA_ID=SELECT C_CUST.CA_ID, C_CUST.CUST_NAME,C_CUST.CUST_LEGAL_NAME,C_CUST.CUST_TYPE, C_CUST.CUST_SUBTYPE, C_CUST.FRANCHISE_FLAG,C_CUST.CUST_STATUS,C_CUST.SOURCE_DELETE_FLAG,C_LU_CUST_SEGMENTATION.SEGMENT_DESC FROM mdm_ors.C_CUST C_CUST INNER JOIN mdm_ors.C_LU_CUST_SEGMENTATION C_LU_CUST_SEGMENTATION ON C_LU_CUST_SEGMENTATION.ROWID_OBJECT = C_CUST.SEGMENT_ROWID WHERE C_CUST.HUB_STATE_IND = 1 and C_CUST.SOURCE_DELETE_FLAG = 'N' and C_CUST.CA_ID ='ca_id1'
CUSTOMER_OTHER_ATTRIBUTES=select * from ( with temp as(SELECT DISTINCT C.CA_ID, C.CUST_NAME, PAC.C_ADDR_LINE_1, hh.COUNTRY_CD_DESC,ii.PROVINCE_CD_DESC,PAC.C_CITY, PAC.C_POSTAL_CD, C.CUST_TYPE, C.CUST_SUBTYPE, C.CUST_STATUS, C_LU_CUST_SEGMENTATION.SEGMENT_DESC FROM MDM_ORS.C_CUST                    C INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN      CPA ON C.ROWID_OBJECT = CPA.CUST_ROWID AND ( CPA.HUB_STATE_IND = 1 AND CPA.SOURCE_DELETE_FLAG = 'N' AND CPA.PADDRESS_TYPE = 'PHYSICAL' AND CPA.PRIMARY_FLAG = 'Y' )INNER JOIN MDM_ORS.C_PADDRESS PAC ON CPA.PADDRESS_ROWID = PAC.ROWID_OBJECT AND PAC.HUB_STATE_IND = 1 AND PAC.SOURCE_DELETE_FLAG = 'N' INNER JOIN MDM_ORS.C_ACCT A ON C.ROWID_OBJECT = A.CUST_ROWID AND A.HUB_STATE_IND = 1 AND A.SOURCE_DELETE_FLAG = 'N' INNER JOIN MDM_ORS.C_ACCT_PADDRESS_ASSN APA ON A.ROWID_OBJECT = APA.ACCT_ROWID AND ( APA.HUB_STATE_IND = 1 AND APA.SOURCE_DELETE_FLAG = 'N'AND APA.PADDRESS_TYPE = 'PHYSICAL' AND APA.PRIMARY_FLAG = 'Y' ) INNER JOIN MDM_ORS.C_PADDRESS PAA ON APA.PADDRESS_ROWID = PAA.ROWID_OBJECT AND PAA.HUB_STATE_IND = 1 AND PAA.SOURCE_DELETE_FLAG = 'N' INNER JOIN MDM_ORS.C_CUST_REL E ON E.CUST_ROWID2 = C.ROWID_OBJECT INNER JOIN MDM_ORS.C_CUST_PRODUCT_CATEGORY   F ON F.CUST_ROWID = C.ROWID_OBJECT AND F.HUB_STATE_IND = 1 AND F.SOURCE_DELETE_FLAG = 'N'INNER JOIN MDM_ORS.C_CUST_CLSF_ASSN          I ON C.ROWID_OBJECT = I.CUST_ROWID AND I.HUB_STATE_IND = 1INNER JOIN mdm_ors.C_LU_COUNTRY hh on hh.COUNTRY_CD = PAC.C_COUNTRY_CD INNER JOIN mdm_ors.C_LU_PROVINCE ii on ii.PROVINCE_CD = PAC.C_PROVINCE_CD INNER JOIN mdm_ors.C_LU_CUST_SEGMENTATION C_LU_CUST_SEGMENTATION ON C_LU_CUST_SEGMENTATION.ROWID_OBJECT = C.SEGMENT_ROWID WHERE C.HUB_STATE_IND = 1 AND C.SOURCE_DELETE_FLAG = 'N' AND E.CUST_ROWID2 IN (SELECT EE.CUST_ROWID2 FROM MDM_ORS.C_CUST_REL        EE JOIN MDM_ORS.C_CUST_REL_XREF   EEXREF ON EE.ROWID_OBJECT = EEXREF.ROWID_OBJECT WHERE EE.HUB_STATE_IND = 1 AND EE.SOURCE_DELETE_FLAG = 'N' AND EEXREF.HUB_STATE_IND = 1 AND EEXREF.PERIOD_END_DATE IS NULL GROUP BY EE.CUST_ROWID2 HAVING  COUNT(DISTINCT EE.CUST_ROWID2) = 1)), temp11 as (select t.*,row_number() over (partition by t.CA_ID order by  t.CUST_NAME desc) as rank from temp t),tempT as( select t1.CA_ID from temp11 t1 inner join temp11 t2 on t1.CA_ID = t2.CA_ID and t1.rank = 1 and t2.rank <> 1) select * from temp where CA_ID not in (select CA_ID from tempT) ORDER BY dbms_random.value) where rownum <=1
CUSTOMER_PRODUCT=SELECT f.CUST_PROD_CAT_TYPE, f.SOURCE_DELETE_FLAG FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_PRODUCT_CATEGORY f on f.CUST_ROWID = a.ROWID_OBJECT and f.hub_state_ind = 1 WHERE a.CA_ID = 'ca_id1' 
CUSTOMER_ADDRESS=SELECT b.PADDRESS_TYPE, c.AV_CODE, c.AV_MESSAGE, b.USE_CLEANSED_FLAG, c.C_ADDR_LINE_1 FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.CUST_ROWID INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID and b.PADDRESS_TYPE in ('PHYSICAL','BILLING') WHERE b.PADDRESS_TYPE='paddress_type1' AND b.hub_state_ind = 1 and a.CA_ID = 'ca_id1' and AV_CODE='av_code1' and AV_MESSAGE='av_message1' and USE_CLEANSED_FLAG='use_cleansed_flag1' and C_ADDR_LINE_1='c1_addr_line1'
CUSTOMER_CLASSIFICATION=select distinct a.CA_ID,c1.CUST_CLSF_TYPE from mdm_ors.c_cust a left join mdm_ors.c_cust_clsf_assn b1 on a.ROWID_OBJECT = b1.CUST_ROWID  left join mdm_ors.c_lu_cust_clsf_type c1 on c1.ROWID_OBJECT = b1.CUST_CLSF_ROWID and c1.HUB_STATE_IND = 1 and b1.HUB_STATE_IND = 1 where a.CA_ID in  ('ca_id1')and c1.CUST_CLSF_TYPE is not null
CUSTOMER_RELATED_ACCOUNT=SELECT d.ACCT_ID, d.ACCT_NAME, d.ACCT_TYPE, ls.ACCT_SUBTYPE_desc as acct_subtype, d.ACCT_ROLE, la.acct_status_desc as acct_status, lft.acct_function_type, a.source_delete_flag FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.CUST_ROWID INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID INNER JOIN MDM_ORS.C_ACCT d on d.CUST_ROWID = a.ROWID_OBJECT INNER JOIN MDM_ORS.C_LU_ACCT_SUBTYPE LS on d.acct_subtype = ls.acct_subtype INNER JOIN MDM_ORS.C_LU_ACCT_STATUS LA on d.acct_status = la.acct_status INNER JOIN MDM_ORS.C_LU_ACCT_FUNCTION_TYPE LFT on d.acct_func_type_rowid = lft.rowid_object WHERE b.PADDRESS_TYPE = 'PHYSICAL' AND b.PRIMARY_FLAG = 'Y' and a.CA_ID = 'ca_id1' and ACCT_ID='acct_id1' 
subjectAreaCustPostAddr=select b.PADDRESS_TYPE, b.PRIMARY_FLAG,b.ATTENTION_TO, b.USE_CLEANSED_FLAG,c.C_ADDR_LINE_1,c.ADDR_LINE_1  from mdm_ors.c_acct a INNER JOIN MDM_ORS.C_ACCT_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.ACCT_ROWID and b.PADDRESS_TYPE in ( 'PHYSICAL','BILLING')  INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID where a.hub_state_ind = 1 and a.source_delete_flag = 'N' and b.hub_state_ind = 1 and b.source_delete_flag = 'N' and c.hub_state_ind = 1 and c.source_delete_flag = 'N' and a.ACCT_ID = 'acct_id1' and PADDRESS_TYPE='paddress_type1' and b.PRIMARY_FLAG='primary_flag1' and b.USE_CLEANSED_FLAG='use_cleansed_flag1'  and c.C_ADDR_LINE_1='cleansed_addr_1' order by b.PADDRESS_TYPE, b.PRIMARY_FLAG desc
CUST_RELATIONSHIPS_SUBJECT=SELECT distinct e1.HIERARCHY_CD, a1.CUST_NAME as CUST_NAME1, a2.CUST_NAME as  CUST_NAME2, e2.PERIOD_START_DATE, e2.PERIOD_END_DATE FROM MDM_ORS.C_CUST a1  INNER JOIN mdm_ors.c_cust_rel e1 on e1.CUST_ROWID1 = a1.ROWID_OBJECT inner join mdm_ors.c_cust_rel_xref e2 on e1.ROWID_OBJECT = e2.ROWID_OBJECT  and e2.PERIOD_END_DATE is null and e2.HUB_STATE_IND = 1 INNER JOIN MDM_ORS.C_CUST a2 on e1.CUST_ROWID2 = a2.ROWID_OBJECT WHERE (a1.CA_ID = 'ca_idr' or a2.CA_ID = 'ca_idr') and a1.CUST_NAME = 'CUST_NAME_FIRST' and a2.CUST_NAME = 'CUST_NAME_SECOND'
CUST_TYPE_SUBTYPE=select CA_ID, CUST_TYPE, CUST_SUBTYPE from mdm_ors.c_cust where CA_ID in ('ca_id1')
CUST_INFO=SELECT CA_ID, UPDATED_BY, DL_REASON, HUB_STATE_IND, SOURCE_DELETE_FLAG FROM mdm_ors.C_CUST where CA_ID in ('ca_id1')
RELATIONSHIP_UPLOAD=SELECT distinct e1.HIERARCHY_CD, a1.CUST_NAME as CUST_NAME1, a2.CUST_NAME as  CUST_NAME2, e2.PERIOD_START_DATE, e2.PERIOD_END_DATE FROM MDM_ORS.C_CUST a1  INNER JOIN mdm_ors.c_cust_rel e1 on e1.CUST_ROWID1 = a1.ROWID_OBJECT inner join mdm_ors.c_cust_rel_xref e2 on e1.ROWID_OBJECT = e2.ROWID_OBJECT  and e2.PERIOD_END_DATE is null and e2.HUB_STATE_IND = 1 INNER JOIN MDM_ORS.C_CUST a2 on e1.CUST_ROWID2 = a2.ROWID_OBJECT WHERE a1.CA_ID = 'parent_CA_ID' and a2.CA_ID = 'child_CA_ID'
USER_INFO_PARENT=SELECT distinct a1.CA_ID,a1.UPDATED_BY as UPDATED_BY_CUST, a1.DL_REASON as DL_REASON_CUST, a1.HUB_STATE_IND as HUB_STATE_IND_CUST, a1.SOURCE_DELETE_FLAG as SOURCE_DELETE_FLAG_CUST , e1.UPDATED_BY as UPDATED_BY_REL, e1.DL_REASON as DL_REASON_REL , e1.HUB_STATE_IND as HUB_STATE_IND_REL , e1.SOURCE_DELETE_FLAG as SOURCE_DELETE_FLAG_REL FROM MDM_ORS.C_CUST a1 INNER JOIN mdm_ors.c_cust_rel e1 on e1.CUST_ROWID1 = a1.ROWID_OBJECT INNER JOIN mdm_ors.c_cust_rel_xref f1 on e1.ROWID_OBJECT = f1.ROWID_OBJECT WHERE a1.CA_ID = 'ca_id1'
USER_INFO_CHILD=SELECT  distinct a1.CA_ID,a1.UPDATED_BY as UPDATED_BY_CUST, a1.DL_REASON as DL_REASON_CUST, a1.HUB_STATE_IND as HUB_STATE_IND_CUST, a1.SOURCE_DELETE_FLAG as SOURCE_DELETE_FLAG_CUST , e1.UPDATED_BY as UPDATED_BY_REL, e1.DL_REASON as DL_REASON_REL , e1.HUB_STATE_IND as HUB_STATE_IND_REL , e1.SOURCE_DELETE_FLAG as SOURCE_DELETE_FLAG_REL FROM MDM_ORS.C_CUST a1 INNER JOIN mdm_ors.c_cust_rel e1 on e1.CUST_ROWID2 = a1.ROWID_OBJECT INNER JOIN mdm_ors.c_cust_rel_xref f1 on e1.ROWID_OBJECT = f1.ROWID_OBJECT WHERE a1.CA_ID = 'ca_id1' 
SOURCE_DELETE_FLAG_REMOVE=select distinct a.SOURCE_DELETE_FLAG from MDM_ORS.C_CUST_REL a inner join mdm_ors.c_cust_rel_xref b on a.ROWID_OBJECT = b.ROWID_OBJECT where a.CUST_ROWID1 in (select rowid_object from MDM_ORS.C_CUST where CA_ID = 'ca_id1')
**** UpdatedBY_AMANNA ******

CUST_SEGMENT=SELECT COUNT(*) as COUNT_DB FROM mdm_ors.C_CUST C_CUST INNER JOIN mdm_ors.C_CUST_PADDRESS_ASSN C_CUST_PADDRESS_ASSN ON C_CUST.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.CUST_ROWID INNER JOIN mdm_ors.C_PADDRESS C_PADDRESS ON C_PADDRESS.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.PADDRESS_ROWID INNER JOIN mdm_ors.C_LU_CUST_SEGMENTATION C_LU_CUST_SEGMENTATION ON C_LU_CUST_SEGMENTATION.ROWID_OBJECT = C_CUST.SEGMENT_ROWID WHERE C_CUST_PADDRESS_ASSN.PADDRESS_TYPE = 'PHYSICAL' AND C_CUST_PADDRESS_ASSN.PRIMARY_FLAG = 'Y' AND C_LU_CUST_SEGMENTATION.SEGMENT_DESC = 'segval' GROUP BY C_LU_CUST_SEGMENTATION.SEGMENT_DESC
CUST_STATUS=SELECT COUNT(*) as COUNT_DB FROM mdm_ors.C_CUST C_CUST INNER JOIN mdm_ors.C_CUST_PADDRESS_ASSN C_CUST_PADDRESS_ASSN ON C_CUST.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.CUST_ROWID INNER JOIN mdm_ors.C_PADDRESS C_PADDRESS ON C_PADDRESS.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.PADDRESS_ROWID WHERE C_CUST_PADDRESS_ASSN.PADDRESS_TYPE = 'PHYSICAL' AND C_CUST_PADDRESS_ASSN.PRIMARY_FLAG = 'Y' AND C_CUST.CUST_STATUS = 'statusval' GROUP BY C_CUST.CUST_STATUS
CUST_SUBTYPE=SELECT COUNT(*) as COUNT_DB FROM mdm_ors.C_CUST C_CUST INNER JOIN mdm_ors.C_CUST_PADDRESS_ASSN C_CUST_PADDRESS_ASSN ON C_CUST.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.CUST_ROWID INNER JOIN mdm_ors.C_PADDRESS C_PADDRESS ON C_PADDRESS.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.PADDRESS_ROWID WHERE C_CUST_PADDRESS_ASSN.PADDRESS_TYPE = 'PHYSICAL' AND C_CUST_PADDRESS_ASSN.PRIMARY_FLAG = 'Y' AND C_CUST.CUST_SUBTYPE = 'subtypeval' GROUP BY C_CUST.CUST_SUBTYPE
CUST_TYPE=SELECT COUNT(*) as COUNT_DB FROM mdm_ors.C_CUST C_CUST INNER JOIN mdm_ors.C_CUST_PADDRESS_ASSN C_CUST_PADDRESS_ASSN ON C_CUST.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.CUST_ROWID INNER JOIN mdm_ors.C_PADDRESS C_PADDRESS ON C_PADDRESS.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.PADDRESS_ROWID WHERE C_CUST_PADDRESS_ASSN.PADDRESS_TYPE = 'PHYSICAL' AND C_CUST_PADDRESS_ASSN.PRIMARY_FLAG = 'Y' AND C_CUST.CUST_TYPE = 'typeval' GROUP BY C_CUST.CUST_TYPE
CUST_POSTALCODE=SELECT COUNT(*) as COUNT_DB FROM (SELECT C_CUST.CA_ID,C_CUST.CUST_TYPE,C_CUST.CUST_SUBTYPE,C_CUST.CUST_STATUS,C_CUST.CUST_NAME,C_PADDRESS.C_ADDR_LINE_1,C_PADDRESS.C_CITY,C_PADDRESS.C_PROVINCE_CD FROM MDM_ORS.C_CUST C_CUST INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN   C_CUST_PADDRESS_ASSN ON C_CUST.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.CUST_ROWID AND C_CUST_PADDRESS_ASSN.HUB_STATE_IND = 1 INNER JOIN MDM_ORS.C_PADDRESS             C_PADDRESS ON C_PADDRESS.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.PADDRESS_ROWID AND C_PADDRESS.HUB_STATE_IND = 1 WHERE C_CUST_PADDRESS_ASSN.PADDRESS_TYPE = 'PHYSICAL' AND C_CUST_PADDRESS_ASSN.PRIMARY_FLAG = 'Y' AND C_PADDRESS.C_POSTAL_CD = 'postalcodeval' AND EXISTS (SELECT 1 FROM MDM_ORS.C_ACCT  C_ACCT INNER JOIN MDM_ORS.C_ACCT_PADDRESS_ASSN   C_ACCT_PADDRESS_ASSN ON C_ACCT.ROWID_OBJECT = C_ACCT_PADDRESS_ASSN.ACCT_ROWID AND C_ACCT_PADDRESS_ASSN.HUB_STATE_IND = 1 INNER JOIN MDM_ORS.C_PADDRESS             C_PADDRESS ON C_PADDRESS.ROWID_OBJECT = C_ACCT_PADDRESS_ASSN.PADDRESS_ROWID AND C_PADDRESS.HUB_STATE_IND = 1 WHERE C_CUST.ROWID_OBJECT = C_ACCT.CUST_ROWID AND C_ACCT.HUB_STATE_IND = 1 AND C_PADDRESS.C_POSTAL_CD = 'postalcodeval') UNION SELECT DISTINCT C_CUST.CA_ID,C_CUST.CUST_TYPE,C_CUST.CUST_SUBTYPE,C_CUST.CUST_STATUS,C_CUST.CUST_NAME,C_PADDRESS.C_ADDR_LINE_1,C_PADDRESS.C_CITY,C_PADDRESS.C_PROVINCE_CD FROM MDM_ORS.C_CUST C_CUST INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN   C_CUST_PADDRESS_ASSN ON C_CUST.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.CUST_ROWID AND C_CUST_PADDRESS_ASSN.HUB_STATE_IND = 1 INNER JOIN MDM_ORS.C_PADDRESS   C_PADDRESS ON C_PADDRESS.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.PADDRESS_ROWID AND C_PADDRESS.HUB_STATE_IND = 1 INNER JOIN MDM_ORS.C_ACCT  C_ACCT ON C_ACCT.CUST_ROWID = C_CUST.ROWID_OBJECT AND C_ACCT.HUB_STATE_IND = 1 INNER JOIN MDM_ORS.C_ACCT_PADDRESS_ASSN   C_ACCT_PADDRESS_ASSN ON C_ACCT.ROWID_OBJECT = C_ACCT_PADDRESS_ASSN.ACCT_ROWID AND C_ACCT_PADDRESS_ASSN.HUB_STATE_IND = 1 INNER JOIN MDM_ORS.C_PADDRESS  C_PADDRESS1 ON C_PADDRESS1.ROWID_OBJECT = C_ACCT_PADDRESS_ASSN.PADDRESS_ROWID AND C_PADDRESS1.HUB_STATE_IND = 1 WHERE C_CUST_PADDRESS_ASSN.PADDRESS_TYPE = 'PHYSICAL' AND C_CUST_PADDRESS_ASSN.PRIMARY_FLAG = 'Y' AND C_PADDRESS1.C_POSTAL_CD = 'postalcodeval')
ident_TestData_Cust_Rel=select CA_ID from (select A.CA_ID from (SELECT distinct a.CA_ID as CA_ID FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_REL e on e.CUST_ROWID1 = a.ROWID_OBJECT INNER JOIN MDM_ORS.C_CUST_REL_XREF f on e.ROWID_OBJECT = f.ROWID_OBJECT WHERE e.CUST_ROWID1 in (select  ee.CUST_ROWID1 from MDM_ORS.C_CUST_REL ee where ee.HUB_STATE_IND = 1 and ee.REL_TYPE_CD = 'CUST2CUST' group by ee.CUST_ROWID1 having count(distinct ee.CUST_ROWID2) =1) AND a.rowid_object not in (select eee.CUST_ROWID2 from MDM_ORS.C_CUST_REL eee where eee.HUB_STATE_IND = 1) AND a.HUB_STATE_IND = 1 AND f.HUB_STATE_IND = 1 and f.PERIOD_END_DATE is NULL and e.CUST_ROWID1 <> e.ULTIMATE_CUST_ROWID  UNION SELECT distinct a.CA_ID as CA_ID FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_REL e on e.CUST_ROWID1 = a.ROWID_OBJECT INNER JOIN MDM_ORS.C_CUST_REL_XREF f on e.ROWID_OBJECT = f.ROWID_OBJECT WHERE e.CUST_ROWID1 in (select  ee.CUST_ROWID1 from MDM_ORS.C_CUST_REL ee where ee.HUB_STATE_IND = 1 and ee.REL_TYPE_CD = 'CUST2CUST' group by ee.CUST_ROWID1 having count(distinct ee.CUST_ROWID2) =1) AND a.HUB_STATE_IND = 1 AND f.HUB_STATE_IND = 1 and f.PERIOD_END_DATE is NULL and e.CUST_ROWID1 = e.ULTIMATE_CUST_ROWID ) A order by dbms_random.value) B where rownum <= 1	
CUST_RELATIONSHIPS=select A.HIERARCHY_CD, A.CUST_NAME as CUST_NAME1, B.CUST_NAME as CUST_NAME2, A.PERIOD_START_DATE, A.PERIOD_END_DATE from (SELECT distinct e1.CUST_ROWID2 as ROWID2, e1.HIERARCHY_CD, a1.CUST_NAME, e2.PERIOD_START_DATE, e2.PERIOD_END_DATE FROM MDM_ORS.C_CUST a1 INNER JOIN mdm_ors.c_cust_rel e1 on e1.CUST_ROWID1 = a1.ROWID_OBJECT inner join mdm_ors.c_cust_rel_xref e2 on e1.ROWID_OBJECT = e2.ROWID_OBJECT  and e2.PERIOD_END_DATE is null and e2.HUB_STATE_IND = 1 WHERE a1.CA_ID = 'ca_idr' ) A, (SELECT distinct a1.rowid_object as ROWID2, e1.HIERARCHY_CD, a1.CUST_NAME, e2.PERIOD_START_DATE, e2.PERIOD_END_DATE FROM MDM_ORS.C_CUST a1 INNER JOIN mdm_ors.c_cust_rel e1 on e1.CUST_ROWID2 = a1.ROWID_OBJECT inner join mdm_ors.c_cust_rel_xref e2 on e1.ROWID_OBJECT = e2.ROWID_OBJECT  and e2.PERIOD_END_DATE is null and e2.HUB_STATE_IND = 1 WHERE a1.rowid_object  in (select CUST_ROWID2 from MDM_ORS.C_CUST_REL e,MDM_ORS.C_CUST a where e.CUST_ROWID1 = a.ROWID_OBJECT and a.CA_ID = 'ca_idr')) B Where A.ROWID2 = B.ROWID2



********************************************* Account  Search   **********************************************************************

acct_sql=SELECT ROWID_OBJECT, CREATE_DATE, LAST_UPDATE_DATE, LAST_ROWID_SYSTEM, CA_ID, CUST_TYPE, CUST_SUBTYPE FROM MDM_ORS.C_CUST where rownum <=1
generic_search_sql=SELECT COUNT(*) as COUNT_DB FROM mdm_ors.C_CUST C_CUST INNER JOIN mdm_ors.C_CUST_PADDRESS_ASSN C_CUST_PADDRESS_ASSN ON C_CUST.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.CUST_ROWID INNER JOIN mdm_ors.C_PADDRESS C_PADDRESS ON C_PADDRESS.ROWID_OBJECT = C_CUST_PADDRESS_ASSN.PADDRESS_ROWID WHERE C_CUST_PADDRESS_ASSN.PADDRESS_TYPE = 'PHYSICAL' AND C_CUST_PADDRESS_ASSN.PRIMARY_FLAG = 'Y'
Ident_TestData_acct=select * from ( with temp as (select a.ACCT_ID from mdm_ors.c_acct a where a.hub_state_ind = 1 and a.source_delete_flag = 'N' group by a.ACCT_ID having count(1) = 1 ) select distinct a.ACCT_ID from mdm_ors.c_acct a INNER JOIN MDM_ORS.C_ACCT_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.ACCT_ROWID and b.PADDRESS_TYPE = 'PHYSICAL' and b.PRIMARY_FLAG = 'Y' INNER JOIN temp t on t.ACCT_ID = a.ACCT_ID INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID INNER JOIN MDM_ORS.c_external_id d on d.ACCT_ROWID = a.ROWID_OBJECT INNER JOIN MDM_ORS.C_CUST e on a.CUST_ROWID = e.ROWID_OBJECT LEFT JOIN MDM_ORS.C_NAMEPLATE_REL f on f.ACCT_ROWID = a.ROWID_OBJECT LEFT JOIN MDM_ORS.C_LU_NAMEPLATE g on g.rowid_object = f.NAMEPLATE_ROWID INNER JOIN mdm_ors.C_LU_COUNTRY h on h.COUNTRY_CD = c.C_COUNTRY_CD INNER JOIN mdm_ors.C_LU_PROVINCE i on i.PROVINCE_CD = c.C_PROVINCE_CD INNER JOIN mdm_ors.C_LU_ACCT_SUBTYPE j on j.ACCT_SUBTYPE = a.ACCT_SUBTYPE INNER JOIN mdm_ors.C_LU_ACCT_STATUS k on k.ACCT_STATUS = a.ACCT_STATUS INNER JOIN mdm_ors.c_lu_acct_function_type l on l.ROWID_OBJECT = a.ACCT_FUNC_TYPE_ROWID where a.hub_state_ind = 1 and a.source_delete_flag = 'N' and b.hub_state_ind = 1 and b.source_delete_flag = 'N' and c.hub_state_ind = 1 and c.source_delete_flag = 'N' and d.hub_state_ind = 1 and d.source_delete_flag = 'N' and e.hub_state_ind = 1 and e.source_delete_flag = 'N' and f.hub_state_ind = 1 and f.source_delete_flag = 'N' and g.hub_state_ind = 1  and a.rowid_object in (select ACCT_ROWID from MDM_ORS.C_NAMEPLATE_REL where ACCT_ROWID in (select  ACCT_ROWID from MDM_ORS.C_NAMEPLATE_REL where HUB_STATE_IND = 1 group by ACCT_ROWID having count(distinct NAMEPLATE_ROWID) =1)) ORDER BY dbms_random.value ) where rownum <=1
Ident2_TestData_acct=select * from ( with temp as (select a.ACCT_ID from mdm_ors.c_acct a where a.hub_state_ind = 1 and a.source_delete_flag = 'N' group by a.ACCT_ID having count(1) = 1 ) select distinct a.ACCT_ID,a.ACCT_NAME,c.C_ADDR_LINE_1,h.COUNTRY_CD_DESC,i.PROVINCE_CD_DESC,c.C_CITY, a.ACCT_TYPE,j.ACCT_SUBTYPE_DESC,a.ACCT_ROLE,k.ACCT_STATUS_DESC, l.ACCT_FUNCTION_TYPE from mdm_ors.c_acct a INNER JOIN MDM_ORS.C_ACCT_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.ACCT_ROWID and b.PADDRESS_TYPE = 'PHYSICAL' and b.PRIMARY_FLAG = 'Y' INNER JOIN temp t on t.ACCT_ID = a.ACCT_ID INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID INNER JOIN MDM_ORS.c_external_id d on d.ACCT_ROWID = a.ROWID_OBJECT INNER JOIN MDM_ORS.C_CUST e on a.CUST_ROWID = e.ROWID_OBJECT LEFT JOIN MDM_ORS.C_NAMEPLATE_REL f on f.ACCT_ROWID = a.ROWID_OBJECT LEFT JOIN MDM_ORS.C_LU_NAMEPLATE g on g.rowid_object = f.NAMEPLATE_ROWID INNER JOIN mdm_ors.C_LU_COUNTRY h on h.COUNTRY_CD = c.C_COUNTRY_CD INNER JOIN mdm_ors.C_LU_PROVINCE i on i.PROVINCE_CD = c.C_PROVINCE_CD INNER JOIN mdm_ors.C_LU_ACCT_SUBTYPE j on j.ACCT_SUBTYPE = a.ACCT_SUBTYPE INNER JOIN mdm_ors.C_LU_ACCT_STATUS k on k.ACCT_STATUS = a.ACCT_STATUS INNER JOIN mdm_ors.c_lu_acct_function_type l on l.ROWID_OBJECT = a.ACCT_FUNC_TYPE_ROWID where a.hub_state_ind = 1 and a.source_delete_flag = 'N' and b.hub_state_ind = 1 and b.source_delete_flag = 'N' and c.hub_state_ind = 1 and c.source_delete_flag = 'N' and d.hub_state_ind = 1 and d.source_delete_flag = 'N' and e.hub_state_ind = 1 and e.source_delete_flag = 'N' and f.hub_state_ind = 1 and f.source_delete_flag = 'N' and g.hub_state_ind = 1 and  a.ACCT_TYPE  not in ('DT')  and a.rowid_object in (select ACCT_ROWID from MDM_ORS.C_NAMEPLATE_REL where ACCT_ROWID in (select  ACCT_ROWID from MDM_ORS.C_NAMEPLATE_REL where HUB_STATE_IND = 1 group by ACCT_ROWID having count(distinct NAMEPLATE_ROWID) =1)) ORDER BY dbms_random.value ) where rownum <=1

subjectAreaAccount=select a.ACCT_ID, a.ACCT_NAME, a.ACCT_TYPE, c.ACCT_SUBTYPE_DESC, a.ACCT_ROLE, a.ACCT_STATUS, b.ACCT_FUNCTION_TYPE,  a.SOURCE_DELETE_FLAG from  mdm_ors.c_acct a inner join mdm_ors.c_lu_acct_function_type b on a.ACCT_FUNC_TYPE_ROWID = b.ROWID_OBJECT inner join mdm_ors.C_LU_ACCT_SUBTYPE c on a.ACCT_SUBTYPE = c.ACCT_SUBTYPE where a.acct_id ='account_id' and a.ACCT_TYPE='acct_type1'  
subjectAreaAcctPostAddr=select distinct b.PADDRESS_TYPE, b.PRIMARY_FLAG,b.ATTENTION_TO, b.USE_CLEANSED_FLAG,c.C_ADDR_LINE_1  from mdm_ors.c_acct a INNER JOIN MDM_ORS.C_ACCT_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.ACCT_ROWID and b.PADDRESS_TYPE in ( 'PHYSICAL','BILLING')  INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID where a.hub_state_ind = 1 and a.source_delete_flag = 'N' and b.hub_state_ind = 1 and b.source_delete_flag = 'N' and c.hub_state_ind = 1 and c.source_delete_flag = 'N'  and PADDRESS_TYPE='paddress_type1' and b.PRIMARY_FLAG='primary_flag1' and b.USE_CLEANSED_FLAG='use_cleansed_flag1'  and c.C_ADDR_LINE_1='cleansed_addr_1'order by b.PADDRESS_TYPE, b.PRIMARY_FLAG desc
subjectAreaExternalId=select d.EXTERNAL_ID_TYPE, d.EXTERNAL_ID, d.SOURCE_DELETE_FLAG  from mdm_ors.c_acct a INNER JOIN MDM_ORS.c_external_id d on d.ACCT_ROWID = a.ROWID_OBJECT where a.hub_state_ind = 1 and a.source_delete_flag = 'N'and d.hub_state_ind = 1 and d.source_delete_flag = 'N'and ACCT_ID = 'account_id' and EXTERNAL_ID_TYPE='externalIdType'
subjectAreaReltedCust=select e.CA_ID,e.CUST_NAME, e.CUST_LEGAL_NAME,e.CUST_TYPE, e.CUST_SUBTYPE   from mdm_ors.c_acct a INNER JOIN MDM_ORS.C_CUST e on a.CUST_ROWID = e.ROWID_OBJECT where a.hub_state_ind = 1 and a.source_delete_flag = 'N' and e.hub_state_ind = 1 and e.source_delete_flag = 'N' and ACCT_ID = 'account_id' and e.CUST_NAME='customerNm'
subjectAreaNameplateRel=select g.NAMEPLATE_DESC, f.SOURCE_DELETE_FLAG, f.OEM_ID, f.START_DATE from mdm_ors.c_acct a INNER JOIN MDM_ORS.C_NAMEPLATE_REL f on f.ACCT_ROWID = a.ROWID_OBJECT INNER JOIN MDM_ORS.C_LU_NAMEPLATE g on g.rowid_object = f.NAMEPLATE_ROWID where a.hub_state_ind = 1 and a.source_delete_flag = 'N' and f.hub_state_ind = 1 and f.source_delete_flag = 'N' and g.hub_state_ind = 1 and ACCT_ID = 'account_id' and NAMEPLATE_DESC='nmpltcd1'
userexit=select CA_ID from (SELECT CA_ID FROM MDM_ORS.PKG_V_CLIENT_CLASS WHERE ULT_PARENT_CA_ID = CA_ID AND CUST_CLSF_TYPE = 'EDP +ONE' AND CA_ID IN (SELECT ULTIMATE_PARENT_CA_ID FROM MDM_ORS.PKG_V_CLIENT_HIERARCHY) AND CA_ID IN (SELECT CA_ID FROM MDM_ORS.PKG_V_CLIENT_CLASS GROUP BY CA_ID HAVING COUNT(*) < 2) ORDER BY dbms_random.value)temp where rownum <=1



********************************************   CACM CustomerUnmerge   ***********************************************************************
custAttrsValUnmerge= select distinct CA_ID, UPDATED_BY, DL_REASON, HUB_STATE_IND, SOURCE_DELETE_FLAG  from mdm_ors.C_CUST   where CA_ID = 'unmergedca_id'
CUSTOMER_CA_ID1=SELECT C_CUST.CA_ID, C_CUST.CUST_NAME,C_CUST.CUST_LEGAL_NAME,C_CUST.CUST_TYPE, C_CUST.CUST_SUBTYPE, C_CUST.FRANCHISE_FLAG,C_CUST.CUST_STATUS,C_CUST.SOURCE_DELETE_FLAG,C_LU_CUST_SEGMENTATION.SEGMENT_DESC FROM mdm_ors.C_CUST C_CUST LEFT JOIN mdm_ors.C_LU_CUST_SEGMENTATION C_LU_CUST_SEGMENTATION ON C_LU_CUST_SEGMENTATION.ROWID_OBJECT = C_CUST.SEGMENT_ROWID WHERE C_CUST.HUB_STATE_IND = 1 and C_CUST.SOURCE_DELETE_FLAG = 'N' and C_CUST.CA_ID ='ca_id11'
CUSTOMER_PRODUCT1=SELECT f.CUST_PROD_CAT_TYPE, f.SOURCE_DELETE_FLAG FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_PRODUCT_CATEGORY f on f.CUST_ROWID = a.ROWID_OBJECT and f.hub_state_ind = 1 WHERE a.CA_ID = 'ca_id11'
CUSTOMER_ADDRESS1=SELECT b.PADDRESS_TYPE, c.AV_CODE, c.AV_MESSAGE, b.USE_CLEANSED_FLAG, c.C_ADDR_LINE_1 FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.CUST_ROWID INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID and b.PADDRESS_TYPE in ('PHYSICAL','BILLING') WHERE b.PADDRESS_TYPE='paddress_type1' AND b.hub_state_ind = 1 and a.CA_ID = 'ca_id1' and AV_CODE='av_code1' and AV_MESSAGE='av_message1' and USE_CLEANSED_FLAG='use_cleansed_flag1' and C_ADDR_LINE_1='c1_addr_line1'
CUSTOMER_CLASSIFICATION1=select distinct a.CA_ID,c1.CUST_CLSF_TYPE from mdm_ors.c_cust a left join mdm_ors.c_cust_clsf_assn b1 on a.ROWID_OBJECT = b1.CUST_ROWID  left join mdm_ors.c_lu_cust_clsf_type c1 on c1.ROWID_OBJECT = b1.CUST_CLSF_ROWID and c1.HUB_STATE_IND = 1 and b1.HUB_STATE_IND = 1 where a.CA_ID in  ('ca_id1')and c1.CUST_CLSF_TYPE is not null
CUSTOMER_RELATED_ACCOUNT1=SELECT d.ACCT_ID, d.ACCT_NAME, d.ACCT_TYPE, ls.ACCT_SUBTYPE_desc as acct_subtype, d.ACCT_ROLE, la.acct_status_desc as acct_status, lft.acct_function_type, a.source_delete_flag FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.CUST_ROWID INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID INNER JOIN MDM_ORS.C_ACCT d on d.CUST_ROWID = a.ROWID_OBJECT INNER JOIN MDM_ORS.C_LU_ACCT_SUBTYPE LS on d.acct_subtype = ls.acct_subtype INNER JOIN MDM_ORS.C_LU_ACCT_STATUS LA on d.acct_status = la.acct_status INNER JOIN MDM_ORS.C_LU_ACCT_FUNCTION_TYPE LFT on d.acct_func_type_rowid = lft.rowid_object WHERE b.PADDRESS_TYPE = 'PHYSICAL' AND b.PRIMARY_FLAG = 'Y' and a.CA_ID = 'ca_id1' and ACCT_ID='acct_id1'
subjectAreaAcctPostAddr1=select b.PADDRESS_TYPE, b.PRIMARY_FLAG,b.ATTENTION_TO, b.USE_CLEANSED_FLAG,c.C_ADDR_LINE_1,c.ADDR_LINE_1  from mdm_ors.c_acct a INNER JOIN MDM_ORS.C_ACCT_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.ACCT_ROWID and b.PADDRESS_TYPE in ( 'PHYSICAL','BILLING')  INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID where a.hub_state_ind = 1 and a.source_delete_flag = 'N' and b.hub_state_ind = 1 and b.source_delete_flag = 'N' and c.hub_state_ind = 1 and c.source_delete_flag = 'N' and a.ACCT_ID = 'acct_id1' and PADDRESS_TYPE='paddress_type1' and b.PRIMARY_FLAG='primary_flag1' and b.USE_CLEANSED_FLAG='use_cleansed_flag1'  and c.C_ADDR_LINE_1='cleansed_addr_1' order by b.PADDRESS_TYPE, b.PRIMARY_FLAG desc
dbValUnmergedRecord1=SELECT distinct CA_ID FROM MDM_ORS.PKG_V_GOLDEN_COMPLETE where CA_ID  = 'unmergedcaid'
dbValIncompletePackage=SELECT distinct CA_ID FROM MDM_ORS.PKG_V_INCOMPLETE_CLIENT WHERE CA_ID = 'unmergedcaid' and REASON like '%Customer do not have Primary Physical Address%'
XrefCAID=select a.CA_ID as ORIG_CA_ID  from mdm_ors.c_cust_xref a inner join mdm_ors.c_cust b on a.ROWID_OBJECT = b.ROWID_OBJECT and b.hub_state_ind = 1 and a.hub_state_ind = 1 where  a.ROWID_SYSTEM <> 'CA' and b.CA_ID = 'winningcaid' minus select CA_ID as ORIG_CA_ID  from  mdm_ors.c_cust where hub_state_ind = 1  and CA_ID = 'winningcaid'
actualunmergedcaidvaluegolden=SELECT distinct CA_ID FROM MDM_ORS.PKG_V_GOLDEN_COMPLETE where CA_ID  in ( actualunmergedcaid)
actualunmergedcaidvaluenongolden=SELECT distinct CA_ID FROM MDM_ORS.PKG_V_INCOMPLETE_CLIENT WHERE CA_ACCT_KEY_ID IS NULL and CA_ID  in ( actualunmergedcaid)

********************************************* Customer Match & Merge   **********************************************************************
CustAddressBeforeMerge=SELECT distinct b.PADDRESS_TYPE , c.AV_CODE , c.AV_MESSAGE , b.USE_CLEANSED_FLAG , c.C_ADDR_LINE_1  FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.CUST_ROWID INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID and b.PADDRESS_TYPE in ('PHYSICAL','BILLING') WHERE  b.hub_state_ind = 1 and a.CA_ID = 'ca_id1' or a.CA_ID = 'ca_id2' order by b.PADDRESS_TYPE , c.AV_CODE , c.AV_MESSAGE , b.USE_CLEANSED_FLAG , c.C_ADDR_LINE_1
CustAddressAfterMerge=SELECT distinct b.PADDRESS_TYPE, c.AV_CODE, c.AV_MESSAGE, b.USE_CLEANSED_FLAG, c.C_ADDR_LINE_1 FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.CUST_ROWID INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID and b.PADDRESS_TYPE in ('PHYSICAL','BILLING') WHERE  b.hub_state_ind = 1 and a.CA_ID = 'caid_merge'  order by b.PADDRESS_TYPE , c.AV_CODE , c.AV_MESSAGE , b.USE_CLEANSED_FLAG , c.C_ADDR_LINE_1
Surviving_CA_ID=select CA_ID from mdm_ors.c_cust where CA_ID in ('caId1','caId2')
custRelatedAccount=SELECT distinct a.CA_ID, d.ACCT_ID, d.ACCT_NAME, d.ACCT_TYPE, ls.ACCT_SUBTYPE_desc as acct_subtype, d.ACCT_ROLE, la.acct_status_desc as acct_status, lft.acct_function_type, a.source_delete_flag FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.CUST_ROWID INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID INNER JOIN MDM_ORS.C_ACCT d on d.CUST_ROWID = a.ROWID_OBJECT INNER JOIN MDM_ORS.C_LU_ACCT_SUBTYPE LS on d.acct_subtype = ls.acct_subtype INNER JOIN MDM_ORS.C_LU_ACCT_STATUS LA on d.acct_status = la.acct_status INNER JOIN MDM_ORS.C_LU_ACCT_FUNCTION_TYPE LFT on d.acct_func_type_rowid = lft.rowid_object WHERE b.PADDRESS_TYPE = 'PHYSICAL' AND b.PRIMARY_FLAG = 'Y' and a.CA_ID in ('ca_id1','ca_id2')  order by d.ACCT_ID, d.ACCT_NAME, d.ACCT_TYPE,ls.ACCT_SUBTYPE_desc,d.ACCT_ROLE
custRelatedAccountAfterMerge=SELECT distinct a.CA_ID, d.ACCT_ID, d.ACCT_NAME, d.ACCT_TYPE, ls.ACCT_SUBTYPE_desc as acct_subtype, d.ACCT_ROLE, la.acct_status_desc as acct_status, lft.acct_function_type, a.source_delete_flag FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_PADDRESS_ASSN b ON a.ROWID_OBJECT = b.CUST_ROWID INNER JOIN MDM_ORS.C_PADDRESS c ON c.ROWID_OBJECT = b.PADDRESS_ROWID INNER JOIN MDM_ORS.C_ACCT d on d.CUST_ROWID = a.ROWID_OBJECT INNER JOIN MDM_ORS.C_LU_ACCT_SUBTYPE LS on d.acct_subtype = ls.acct_subtype INNER JOIN MDM_ORS.C_LU_ACCT_STATUS LA on d.acct_status = la.acct_status INNER JOIN MDM_ORS.C_LU_ACCT_FUNCTION_TYPE LFT on d.acct_func_type_rowid = lft.rowid_object WHERE b.PADDRESS_TYPE = 'PHYSICAL' AND b.PRIMARY_FLAG = 'Y' and a.CA_ID = 'caid_merge'  order by d.ACCT_ID, d.ACCT_NAME, d.ACCT_TYPE,ls.ACCT_SUBTYPE_desc,d.ACCT_ROLE
custHmrgVal=select distinct cust.CA_ID from mdm_ors.c_cust_hmrg hmrg inner join  mdm_ors.c_cust cust on hmrg.TGT_ROWID_OBJECT=cust.ROWID_OBJECT where cust.CA_ID='caid_hmrg'
custAttrsVal=SELECT CA_ID, UPDATED_BY, DL_REASON, HUB_STATE_IND, SOURCE_DELETE_FLAG FROM mdm_ors.C_CUST where CA_ID in ('caIdAttr')


********************************************   CACM CustomerEDP+ONEClassificationAdd   ***********************************************************************
ident_TestData_Cust_Classification_Add=select CA_ID from ( select distinct CA_ID from ( select AA.*, row_number() over (partition by AA.CA_ID order by  AA.HUB_STATE_IND desc) as rank from ( select distinct 'CUST WITH CLSFN' as CUST_TYPE, a.CA_ID, c.CUST_CLSF_TYPE,b.HUB_STATE_IND from mdm_ors.c_cust a  inner join mdm_ors.c_cust_clsf_assn b on a.ROWID_OBJECT = b.CUST_ROWID   inner join mdm_ors.c_lu_cust_clsf_type c on c.ROWID_OBJECT = b.CUST_CLSF_ROWID where cust_type = 'DEALER GROUP' and a.HUB_STATE_IND = 1 and b.HUB_STATE_IND = 1 and  a.CUST_TYPE <> 'OEM'  and not exists (select 1 from mdm_ors.c_cust_clsf_assn b1 inner join mdm_ors.c_lu_cust_clsf_type c1 on c1.ROWID_OBJECT = b1.CUST_CLSF_ROWID where c1.HUB_STATE_IND = 1 and b1.HUB_STATE_IND = 1 and c1.CUST_CLSF_TYPE  not in ('OEM PARTNER+') and b1.CUST_ROWID= a.ROWID_OBJECT)  and a.rowid_object not in (select distinct cr.CUST_ROWID2 from mdm_ors.c_cust_rel cr inner join mdm_ors.c_cust_rel_xref crx on cr.ROWID_OBJECT = cr.ROWID_OBJECT  where cr.HUB_STATE_IND = 1 and cr.REL_TYPE_CD = 'CUST2CUST' and  crx.HUB_STATE_IND = 1 and crx.PERIOD_END_DATE is NULL)  and a.rowid_object  in (select distinct cr.CUST_ROWID1 from mdm_ors.c_cust_rel cr inner join mdm_ors.c_cust_rel_xref crx on cr.ROWID_OBJECT = cr.ROWID_OBJECT  where cr.HUB_STATE_IND = 1 and cr.REL_TYPE_CD = 'CUST2CUST' and  crx.HUB_STATE_IND = 1 and crx.PERIOD_END_DATE is NULL) UNION select distinct 'CUST W/O CLSFN' as CUST_TYPE, CA_ID, CUST_CLSF_TYPE,HUB_STATE_IND from (select distinct a.CA_ID, c.CUST_CLSF_TYPE,b.HUB_STATE_IND,b.rowid_object from mdm_ors.c_cust a  left join mdm_ors.c_cust_clsf_assn b on a.ROWID_OBJECT = b.CUST_ROWID and b.HUB_STATE_IND = 1  left join mdm_ors.c_lu_cust_clsf_type c on c.ROWID_OBJECT = b.CUST_CLSF_ROWID and b.HUB_STATE_IND = 1 and c.HUB_STATE_IND = 1  INNER JOIN MDM_ORS.C_CUST_REL e on e.CUST_ROWID1 = a.ROWID_OBJECT  where a.HUB_STATE_IND = 1 and e.CUST_ROWID1 = e.ULTIMATE_CUST_ROWID  and a.rowid_object not in (select distinct cr.CUST_ROWID2 from mdm_ors.c_cust_rel cr inner join mdm_ors.c_cust_rel_xref crx on cr.ROWID_OBJECT = cr.ROWID_OBJECT  where cr.HUB_STATE_IND = 1 and cr.REL_TYPE_CD = 'CUST2CUST' and  crx.HUB_STATE_IND = 1 and crx.PERIOD_END_DATE is NULL)   and a.rowid_object  in (select distinct cr.CUST_ROWID1 from mdm_ors.c_cust_rel cr inner join mdm_ors.c_cust_rel_xref crx on cr.ROWID_OBJECT = cr.ROWID_OBJECT  where cr.HUB_STATE_IND = 1 and cr.REL_TYPE_CD = 'CUST2CUST' and  crx.HUB_STATE_IND = 1 and crx.PERIOD_END_DATE is NULL) ) where rowid_object is null UNION select distinct 'ULTIMATE PARENT' as CUST_TYPE, CA_ID, CUST_CLSF_TYPE,HUB_STATE_IND from (SELECT distinct a.CA_ID,c.CUST_CLSF_TYPE,b.HUB_STATE_IND,b.rowid_object FROM MDM_ORS.C_CUST a INNER JOIN MDM_ORS.C_CUST_REL e on e.CUST_ROWID1 = a.ROWID_OBJECT INNER JOIN MDM_ORS.C_CUST_REL_XREF f on e.ROWID_OBJECT = f.ROWID_OBJECT left join mdm_ors.c_cust_clsf_assn b on a.ROWID_OBJECT = b.CUST_ROWID and b.HUB_STATE_IND = 1  left join mdm_ors.c_lu_cust_clsf_type c on c.ROWID_OBJECT = b.CUST_CLSF_ROWID and b.HUB_STATE_IND = 1 and c.HUB_STATE_IND = 1  WHERE e.REL_TYPE_CD = 'CUST2CUST' AND a.HUB_STATE_IND = 1 AND f.HUB_STATE_IND = 1 and f.PERIOD_END_DATE is NULL and e.CUST_ROWID1 = e.ULTIMATE_CUST_ROWID  ) where rowid_object is null )AA ) where rank = 1 order by dbms_random.value ) AAA where rownum <= 1
VerifyAddedClassification=select distinct a.CA_ID,  c2.CUST_CLSF_TYPE as ADDED_CLSF, a.HUB_STATE_IND from mdm_ors.c_cust a inner join mdm_ors.c_cust_clsf_assn b1 on a.ROWID_OBJECT = b1.CUST_ROWID   inner join mdm_ors.c_cust_clsf_assn b2 on a.ROWID_OBJECT = b2.CUST_ROWID   inner join mdm_ors.c_lu_cust_clsf_type c2 on c2.ROWID_OBJECT = b2.CUST_CLSF_ROWID and c2.CUST_CLSF_TYPE = 'EDP +ONE' where a.CA_ID in ('ca_id1')
custAttrsValClsfAdd=select distinct CA_ID, UPDATED_BY, DL_REASON, HUB_STATE_IND, SOURCE_DELETE_FLAG  from mdm_ors.C_CUST   where CA_ID = 'ca_id11'

********************************************   CACM CustomerEDP+ONEClassificationRemove   ***********************************************************************
ident_TestData_Cust_Classification_Remove=select CA_ID from (select a.CA_ID, c.CUST_CLSF_TYPE,b.HUB_STATE_IND from mdm_ors.c_cust a inner join mdm_ors.c_cust_clsf_assn b on a.ROWID_OBJECT = b.CUST_ROWID   inner join mdm_ors.c_lu_cust_clsf_type c on c.ROWID_OBJECT = b.CUST_CLSF_ROWID  where cust_type = 'DEALER GROUP' and a.HUB_STATE_IND = 1 and b.HUB_STATE_IND = 1 and c.CUST_CLSF_TYPE = 'EDP +ONE' order by dbms_random.value) B where rownum <= 1
VerifyRemovedClassification=select distinct a.CA_ID, c.CUST_CLSF_TYPE, b.HUB_STATE_IND from mdm_ors.c_cust a inner join mdm_ors.c_cust_clsf_assn b on a.ROWID_OBJECT = b.CUST_ROWID   inner join mdm_ors.c_lu_cust_clsf_type c on c.ROWID_OBJECT = b.CUST_CLSF_ROWID  where a.CA_ID in ('ca_id1') and cust_type = 'DEALER GROUP' and a.HUB_STATE_IND = 1 and b.HUB_STATE_IND = -1 and c.CUST_CLSF_TYPE = 'EDP +ONE'
custAttrsValClsfAdd=select distinct CA_ID, UPDATED_BY, DL_REASON, HUB_STATE_IND, SOURCE_DELETE_FLAG  from mdm_ors.C_CUST   where CA_ID = 'ca_id11'

